-- WARNING: This schema is for context only and is not meant to be run.
-- Table order and constraints may not be valid for execution.

CREATE TABLE public.appointments (
  id uuid NOT NULL DEFAULT uuid_generate_v4(),
  user_id uuid,
  pet_id uuid,
  veterinarian_id uuid,
  appointment_type USER-DEFINED NOT NULL,
  appointment_date timestamp with time zone NOT NULL,
  status USER-DEFINED DEFAULT 'scheduled'::appointment_status,
  notes text,
  diagnosis text,
  treatment text,
  approval_status USER-DEFINED DEFAULT 'pending'::approval_status,
  approved_by uuid,
  approved_at timestamp with time zone,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  reason text,
  vet_id uuid,
  CONSTRAINT appointments_pkey PRIMARY KEY (id),
  CONSTRAINT fk_appointments_vet FOREIGN KEY (veterinarian_id) REFERENCES public.users(id),
  CONSTRAINT fk_appointments_user FOREIGN KEY (user_id) REFERENCES public.users(id),
  CONSTRAINT appointments_user_id_fkey FOREIGN KEY (user_id) REFERENCES public.users(id),
  CONSTRAINT appointments_veterinarian_id_fkey FOREIGN KEY (veterinarian_id) REFERENCES public.users(id),
  CONSTRAINT appointments_pet_id_fkey FOREIGN KEY (pet_id) REFERENCES public.pets(id),
  CONSTRAINT appointments_approved_by_fkey FOREIGN KEY (approved_by) REFERENCES public.users(id)
);
CREATE TABLE public.articles (
  id uuid NOT NULL DEFAULT uuid_generate_v4(),
  author_id uuid,
  title character varying NOT NULL,
  excerpt text,
  content text NOT NULL,
  category character varying NOT NULL,
  featured_image_url text,
  is_published boolean DEFAULT false,
  published_at timestamp with time zone,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT articles_pkey PRIMARY KEY (id),
  CONSTRAINT articles_author_id_fkey FOREIGN KEY (author_id) REFERENCES public.users(id)
);
CREATE TABLE public.health_records (
  id uuid NOT NULL DEFAULT uuid_generate_v4(),
  pet_id uuid,
  record_type USER-DEFINED NOT NULL,
  title character varying NOT NULL,
  description text,
  record_date date NOT NULL,
  next_due_date date,
  veterinarian_id uuid,
  attachments jsonb,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  diagnosis text,
  notes text,
  treatment text,
  weight numeric,
  CONSTRAINT health_records_pkey PRIMARY KEY (id),
  CONSTRAINT health_records_veterinarian_id_fkey FOREIGN KEY (veterinarian_id) REFERENCES public.users(id),
  CONSTRAINT health_records_pet_id_fkey FOREIGN KEY (pet_id) REFERENCES public.pets(id)
);
CREATE TABLE public.notifications (
  id uuid NOT NULL DEFAULT uuid_generate_v4(),
  user_id uuid,
  pet_id uuid,
  notification_type USER-DEFINED NOT NULL,
  title character varying NOT NULL,
  message text NOT NULL,
  due_date date,
  priority USER-DEFINED DEFAULT 'medium'::priority_level,
  is_read boolean DEFAULT false,
  is_completed boolean DEFAULT false,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT notifications_pkey PRIMARY KEY (id),
  CONSTRAINT notifications_pet_id_fkey FOREIGN KEY (pet_id) REFERENCES public.pets(id),
  CONSTRAINT notifications_user_id_fkey FOREIGN KEY (user_id) REFERENCES public.users(id)
);
CREATE TABLE public.nutrition_guidelines (
  id uuid NOT NULL DEFAULT uuid_generate_v4(),
  veterinarian_id uuid,
  species character varying NOT NULL,
  age_range character varying NOT NULL,
  daily_calories integer NOT NULL,
  protein_percentage numeric NOT NULL,
  fat_percentage numeric NOT NULL,
  feeding_frequency integer NOT NULL,
  instructions text,
  approval_status USER-DEFINED DEFAULT 'pending'::approval_status,
  approved_by uuid,
  approved_at timestamp with time zone,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT nutrition_guidelines_pkey PRIMARY KEY (id),
  CONSTRAINT nutrition_guidelines_veterinarian_id_fkey FOREIGN KEY (veterinarian_id) REFERENCES public.users(id),
  CONSTRAINT nutrition_guidelines_approved_by_fkey FOREIGN KEY (approved_by) REFERENCES public.users(id)
);
CREATE TABLE public.pet_nutrition_plans (
  id uuid NOT NULL DEFAULT uuid_generate_v4(),
  pet_id uuid,
  guideline_id uuid,
  custom_calories integer,
  custom_instructions text,
  start_date date DEFAULT CURRENT_DATE,
  end_date date,
  is_active boolean DEFAULT true,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT pet_nutrition_plans_pkey PRIMARY KEY (id),
  CONSTRAINT pet_nutrition_plans_guideline_id_fkey FOREIGN KEY (guideline_id) REFERENCES public.nutrition_guidelines(id),
  CONSTRAINT pet_nutrition_plans_pet_id_fkey FOREIGN KEY (pet_id) REFERENCES public.pets(id)
);
CREATE TABLE public.pets (
  id uuid NOT NULL DEFAULT uuid_generate_v4(),
  user_id uuid,
  name character varying NOT NULL,
  species character varying NOT NULL,
  breed character varying,
  birth_date date,
  gender USER-DEFINED,
  weight numeric,
  color character varying,
  microchip_id character varying,
  photo_url text,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT pets_pkey PRIMARY KEY (id),
  CONSTRAINT pets_user_id_fkey FOREIGN KEY (user_id) REFERENCES public.users(id)
);
CREATE TABLE public.users (
  id uuid NOT NULL DEFAULT uuid_generate_v4(),
  email character varying NOT NULL UNIQUE,
  password_hash character varying NOT NULL,
  full_name character varying NOT NULL,
  role USER-DEFINED DEFAULT 'user'::user_role,
  phone character varying,
  address text,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  profile_picture_url text,
  CONSTRAINT users_pkey PRIMARY KEY (id)
);