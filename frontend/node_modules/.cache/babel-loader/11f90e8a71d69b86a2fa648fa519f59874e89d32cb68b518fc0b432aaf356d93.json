{"ast":null,"code":"\"use client\";import{useState,useEffect}from\"react\";import{useParams,Link,useLocation,useNavigate}from\"react-router-dom\";import{petService}from\"../services\";import{useAuth}from\"../contexts/AuthContext\";import{useApi}from\"../hooks\";import{ArrowLeft,Utensils,Edit,Power,Trash2}from\"lucide-react\";import apiClient from\"../services/api\";import VetNutritionForm from\"../components/VetNutritionForm\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const NutritionRecommendation=()=>{var _vetRecommendation$pe,_vetRecommendation$ve,_vetRecommendation$pe2,_vetRecommendation$pe3,_vetRecommendation$pe4;const{petId}=useParams();const{user}=useAuth();const location=useLocation();const navigate=useNavigate();const[pet,setPet]=useState(null);const[vetRecommendation,setVetRecommendation]=useState(null);const[allPlans,setAllPlans]=useState([]);// plans for current pet\nconst[overviewPlans,setOverviewPlans]=useState([]);// plans for all pets (overview mode)\nconst[showVetForm,setShowVetForm]=useState(false);const{loading,execute}=useApi();useEffect(()=>{if(petId){fetchPetData();fetchVetRecommendations();}else{// โหมดภาพรวม: ดึงแผนของสัตว์เลี้ยงทุกตัวของผู้ใช้\n(async()=>{try{const response=await apiClient.get('/nutrition/recommendations');const plans=Array.isArray(response.data)?response.data:[];setOverviewPlans(plans);}catch(e){console.error('Failed to fetch overview nutrition plans:',e);}})();}},[petId]);const fetchPetData=async()=>{const result=await execute(()=>petService.getPet(petId),{onSuccess:result=>setPet(result.pet),onError:error=>console.error(\"Failed to fetch pet data:\",error)});};const fetchVetRecommendations=async()=>{try{console.log('[NR] petId:',petId);// สร้าง URL โดยไม่ส่ง pet_id ถ้าเป็น undefined\nlet url='/nutrition/recommendations';if(petId&&petId!=='undefined'){url+=`?pet_id=${petId}`;}const response=await apiClient.get(url);console.log('[NR] response:',response.status,response.data);const plans=Array.isArray(response.data)?response.data:[];setAllPlans(plans);// อ่าน plan_id จาก query หากมี ให้ set เป็นรายการที่เลือก\nconst query=new URLSearchParams(location.search);const planId=query.get('plan_id');if(planId){const found=plans.find(p=>p.id===planId);if(found)setVetRecommendation(found);else if(plans.length>0)setVetRecommendation(plans[0]);}else if(plans.length>0){setVetRecommendation(plans[0]);}}catch(error){console.error(\"Failed to fetch vet recommendation:\",error);}};// ตัดการใช้งาน AI recommendation ออกตามข้อกำหนดใหม่\nconst handleVetRecSaved=savedRec=>{setVetRecommendation(savedRec);setShowVetForm(false);// Refresh the plans list\nfetchVetRecommendations();};const handleToggleStatus=async planId=>{try{const response=await apiClient.patch(`/nutrition/recommendations/${planId}/toggle-status`);// Update the plan in the list\nsetAllPlans(prevPlans=>prevPlans.map(plan=>plan.id===planId?response.data:plan));// If this is the currently selected plan, update it too\nif((vetRecommendation===null||vetRecommendation===void 0?void 0:vetRecommendation.id)===planId){setVetRecommendation(response.data);}}catch(error){var _error$response,_error$response$data;console.error(\"Failed to toggle plan status:\",error);// Show error message to user\nconst errorMessage=((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.error)||\"ไม่สามารถเปลี่ยนสถานะแผนได้\";alert(errorMessage);}};const handleDeletePlan=async planId=>{if(!window.confirm(\"คุณแน่ใจหรือไม่ที่จะลบแผนโภชนาการนี้?\")){return;}try{await apiClient.delete(`/nutrition/recommendations/${planId}`);// Remove the plan from the list\nsetAllPlans(prevPlans=>prevPlans.filter(plan=>plan.id!==planId));// If this was the currently selected plan, clear it\nif((vetRecommendation===null||vetRecommendation===void 0?void 0:vetRecommendation.id)===planId){setVetRecommendation(null);}}catch(error){var _error$response2,_error$response2$data;console.error(\"Failed to delete plan:\",error);// Show error message to user\nconst errorMessage=((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.error)||\"ไม่สามารถลบแผนได้\";alert(errorMessage);}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-32 w-32 border-b-2 border-green-500\"})});}return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-50 py-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8\",children:[petId&&/*#__PURE__*/_jsxs(Link,{to:`/pets/${petId}`,className:\"inline-flex items-center space-x-2 text-green-500 hover:text-green-600 mb-8\",children:[/*#__PURE__*/_jsx(ArrowLeft,{className:\"h-4 w-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0E01\\u0E25\\u0E31\\u0E1A\\u0E44\\u0E1B\\u0E2B\\u0E19\\u0E49\\u0E32\\u0E2A\\u0E31\\u0E15\\u0E27\\u0E4C\\u0E40\\u0E25\\u0E35\\u0E49\\u0E22\\u0E07\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card mb-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(Utensils,{className:\"h-8 w-8 text-orange-500\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-gray-900\",children:\"\\u0E04\\u0E33\\u0E41\\u0E19\\u0E30\\u0E19\\u0E33\\u0E42\\u0E20\\u0E0A\\u0E19\\u0E32\\u0E01\\u0E32\\u0E23\"}),petId?/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600\",children:[\"\\u0E2A\\u0E33\\u0E2B\\u0E23\\u0E31\\u0E1A \",pet===null||pet===void 0?void 0:pet.name]}):/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"\\u0E23\\u0E27\\u0E21\\u0E17\\u0E38\\u0E01\\u0E15\\u0E31\\u0E27\\u0E02\\u0E2D\\u0E07\\u0E09\\u0E31\\u0E19\"})]})]})}),!petId&&/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-4\",children:\"\\u0E41\\u0E1C\\u0E19\\u0E42\\u0E20\\u0E0A\\u0E19\\u0E32\\u0E01\\u0E32\\u0E23\\u0E17\\u0E31\\u0E49\\u0E07\\u0E2B\\u0E21\\u0E14\\u0E02\\u0E2D\\u0E07\\u0E09\\u0E31\\u0E19\"}),overviewPlans.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"\\u0E22\\u0E31\\u0E07\\u0E44\\u0E21\\u0E48\\u0E21\\u0E35\\u0E41\\u0E1C\\u0E19\\u0E42\\u0E20\\u0E0A\\u0E19\\u0E32\\u0E01\\u0E32\\u0E23\"}):/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:overviewPlans.map(plan=>{var _plan$pets,_plan$veterinarian,_plan$pets2,_plan$pets3;return/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 rounded border border-gray-200\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium\",children:((_plan$pets=plan.pets)===null||_plan$pets===void 0?void 0:_plan$pets.name)||'ไม่ทราบชื่อ'}),/*#__PURE__*/_jsx(\"span\",{className:`text-xs px-2 py-0.5 rounded ${plan.is_active?'bg-green-100 text-green-700':'bg-gray-100 text-gray-600'}`,children:plan.is_active?'Active':'Inactive'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-600 mb-2\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0E2A\\u0E31\\u0E15\\u0E27\\u0E41\\u0E1E\\u0E17\\u0E22\\u0E4C:\"}),\" \",((_plan$veterinarian=plan.veterinarian)===null||_plan$veterinarian===void 0?void 0:_plan$veterinarian.full_name)||'ไม่ระบุ']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0E2A\\u0E31\\u0E15\\u0E27\\u0E4C\\u0E40\\u0E25\\u0E35\\u0E49\\u0E22\\u0E07:\"}),\" \",(_plan$pets2=plan.pets)===null||_plan$pets2===void 0?void 0:_plan$pets2.species,\" - \",((_plan$pets3=plan.pets)===null||_plan$pets3===void 0?void 0:_plan$pets3.breed)||'ไม่ระบุพันธุ์']})]}),plan.custom_calories&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-600 mt-1\",children:[\"\\u0E41\\u0E04\\u0E25\\u0E2D\\u0E23\\u0E35\\u0E48/\\u0E27\\u0E31\\u0E19: \",plan.custom_calories]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-3\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn-secondary btn-sm\",onClick:()=>navigate(`/pets/${plan.pet_id}/nutrition?plan_id=${plan.id}`),children:\"\\u0E14\\u0E39\\u0E23\\u0E32\\u0E22\\u0E25\\u0E30\\u0E40\\u0E2D\\u0E35\\u0E22\\u0E14\"})})]},plan.id);})})]}),petId&&/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card md:col-span-1\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-1\",children:\"\\u0E41\\u0E1C\\u0E19\\u0E17\\u0E31\\u0E49\\u0E07\\u0E2B\\u0E21\\u0E14\\u0E02\\u0E2D\\u0E07\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mb-3\",children:(pet===null||pet===void 0?void 0:pet.name)||'สัตว์เลี้ยงนี้'}),allPlans.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"\\u0E22\\u0E31\\u0E07\\u0E44\\u0E21\\u0E48\\u0E21\\u0E35\\u0E41\\u0E1C\\u0E19\"}):/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:allPlans.map(plan=>{var _plan$custom_calories;return/*#__PURE__*/_jsxs(\"div\",{className:`w-full p-3 rounded border ${(vetRecommendation===null||vetRecommendation===void 0?void 0:vetRecommendation.id)===plan.id?'border-green-500 bg-green-50':'border-gray-200'}`,children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{setVetRecommendation(plan);navigate({pathname:`/pets/${petId}/nutrition`,search:`?plan_id=${plan.id}`});},className:\"w-full text-left\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:plan.is_active?'แผนปัจจุบัน':'แผนก่อนหน้า'}),/*#__PURE__*/_jsx(\"span\",{className:`text-xs px-2 py-0.5 rounded ${plan.is_active?'bg-green-100 text-green-700':'bg-gray-100 text-gray-600'}`,children:plan.is_active?'Active':'Inactive'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-600 mt-1\",children:[\"\\u0E41\\u0E04\\u0E25\\u0E2D\\u0E23\\u0E35\\u0E48/\\u0E27\\u0E31\\u0E19: \",(_plan$custom_calories=plan.custom_calories)!==null&&_plan$custom_calories!==void 0?_plan$custom_calories:'-']}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500\",children:[\"\\u0E40\\u0E23\\u0E34\\u0E48\\u0E21: \",new Date(plan.start_date).toLocaleDateString('th-TH')]})]}),(user===null||user===void 0?void 0:user.role)==='veterinarian'&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-end space-x-2 mt-2 pt-2 border-t border-gray-200\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:e=>{e.stopPropagation();handleToggleStatus(plan.id);},className:`text-xs px-2 py-1 rounded flex items-center space-x-1 ${plan.is_active?'text-orange-600 hover:bg-orange-50':'text-green-600 hover:bg-green-50'}`,title:plan.is_active?'ปิดใช้งาน':'เปิดใช้งาน',children:[/*#__PURE__*/_jsx(Power,{size:12}),/*#__PURE__*/_jsx(\"span\",{children:plan.is_active?'ปิด':'เปิด'})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:e=>{e.stopPropagation();handleDeletePlan(plan.id);},className:\"text-xs px-2 py-1 rounded text-red-600 hover:bg-red-50 flex items-center space-x-1\",title:\"\\u0E25\\u0E1A\\u0E41\\u0E1C\\u0E19\",children:[/*#__PURE__*/_jsx(Trash2,{size:12}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0E25\\u0E1A\"})]})]})]},plan.id);})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"md:col-span-2\",children:vetRecommendation?/*#__PURE__*/_jsx(\"div\",{className:\"card border-l-4 border-green-500\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-2\",children:\"\\u0E23\\u0E32\\u0E22\\u0E25\\u0E30\\u0E40\\u0E2D\\u0E35\\u0E22\\u0E14\\u0E04\\u0E33\\u0E41\\u0E19\\u0E30\\u0E19\\u0E33\\u0E08\\u0E32\\u0E01\\u0E2A\\u0E31\\u0E15\\u0E27\\u0E41\\u0E1E\\u0E17\\u0E22\\u0E4C\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3 p-3 bg-gray-50 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600 mb-1\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0E2A\\u0E31\\u0E15\\u0E27\\u0E4C\\u0E40\\u0E25\\u0E35\\u0E49\\u0E22\\u0E07:\"}),\" \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:((_vetRecommendation$pe=vetRecommendation.pets)===null||_vetRecommendation$pe===void 0?void 0:_vetRecommendation$pe.name)||'ไม่ระบุ'})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600 mb-1\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0E2A\\u0E31\\u0E15\\u0E27\\u0E41\\u0E1E\\u0E17\\u0E22\\u0E4C:\"}),\" \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:((_vetRecommendation$ve=vetRecommendation.veterinarian)===null||_vetRecommendation$ve===void 0?void 0:_vetRecommendation$ve.full_name)||'ไม่ระบุ'})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-500\",children:[(_vetRecommendation$pe2=vetRecommendation.pets)===null||_vetRecommendation$pe2===void 0?void 0:_vetRecommendation$pe2.species,\" - \",((_vetRecommendation$pe3=vetRecommendation.pets)===null||_vetRecommendation$pe3===void 0?void 0:_vetRecommendation$pe3.breed)||'ไม่ระบุพันธุ์',\" | \\u0E19\\u0E49\\u0E33\\u0E2B\\u0E19\\u0E31\\u0E01: \",(_vetRecommendation$pe4=vetRecommendation.pets)!==null&&_vetRecommendation$pe4!==void 0&&_vetRecommendation$pe4.weight?`${vetRecommendation.pets.weight} กก.`:'ไม่ระบุ']})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-700 leading-relaxed whitespace-pre-line\",children:vetRecommendation.custom_instructions}),vetRecommendation.custom_calories&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-700 mt-3\",children:[\"\\u0E1E\\u0E25\\u0E31\\u0E07\\u0E07\\u0E32\\u0E19\\u0E41\\u0E19\\u0E30\\u0E19\\u0E33\\u0E15\\u0E48\\u0E2D\\u0E27\\u0E31\\u0E19: \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:vetRecommendation.custom_calories}),\" kcal\"]})]}),(user===null||user===void 0?void 0:user.role)==='veterinarian'&&!showVetForm&&/*#__PURE__*/_jsx(\"div\",{className:\"flex space-x-2\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowVetForm(true),className:\"btn-secondary btn-sm\",children:/*#__PURE__*/_jsx(Edit,{size:16})})})]})}):/*#__PURE__*/_jsx(\"div\",{className:\"card\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"\\u0E22\\u0E31\\u0E07\\u0E44\\u0E21\\u0E48\\u0E21\\u0E35\\u0E41\\u0E1C\\u0E19\\u0E17\\u0E35\\u0E48\\u0E40\\u0E25\\u0E37\\u0E2D\\u0E01\"})})})]}),(user===null||user===void 0?void 0:user.role)==='veterinarian'&&showVetForm&&/*#__PURE__*/_jsx(VetNutritionForm,{petId:petId||null,existingRecommendation:vetRecommendation===null||vetRecommendation===void 0?void 0:vetRecommendation.custom_instructions,planId:vetRecommendation===null||vetRecommendation===void 0?void 0:vetRecommendation.id,onSave:handleVetRecSaved,onCancel:()=>setShowVetForm(false)}),(user===null||user===void 0?void 0:user.role)==='veterinarian'&&!showVetForm&&/*#__PURE__*/_jsx(\"div\",{className:\"text-center mt-8\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowVetForm(true),className:\"btn-outline\",children:[/*#__PURE__*/_jsx(Edit,{size:18,className:\"mr-2\"}),petId?'เพิ่มคำแนะนำจากสัตวแพทย์':'สร้างแผนโภชนาการใหม่']})})]})});};export default NutritionRecommendation;","map":{"version":3,"names":["useState","useEffect","useParams","Link","useLocation","useNavigate","petService","useAuth","useApi","ArrowLeft","Utensils","Edit","Power","Trash2","apiClient","VetNutritionForm","jsx","_jsx","jsxs","_jsxs","NutritionRecommendation","_vetRecommendation$pe","_vetRecommendation$ve","_vetRecommendation$pe2","_vetRecommendation$pe3","_vetRecommendation$pe4","petId","user","location","navigate","pet","setPet","vetRecommendation","setVetRecommendation","allPlans","setAllPlans","overviewPlans","setOverviewPlans","showVetForm","setShowVetForm","loading","execute","fetchPetData","fetchVetRecommendations","response","get","plans","Array","isArray","data","e","console","error","result","getPet","onSuccess","onError","log","url","status","query","URLSearchParams","search","planId","found","find","p","id","length","handleVetRecSaved","savedRec","handleToggleStatus","patch","prevPlans","map","plan","_error$response","_error$response$data","errorMessage","alert","handleDeletePlan","window","confirm","delete","filter","_error$response2","_error$response2$data","className","children","to","name","_plan$pets","_plan$veterinarian","_plan$pets2","_plan$pets3","pets","is_active","veterinarian","full_name","species","breed","custom_calories","onClick","pet_id","_plan$custom_calories","pathname","Date","start_date","toLocaleDateString","role","stopPropagation","title","size","weight","custom_instructions","existingRecommendation","onSave","onCancel"],"sources":["D:/senior.project/pet-health-docs/frontend/src/pages/NutritionRecommendation.js"],"sourcesContent":["\"use client\"\n\nimport { useState, useEffect } from \"react\"\nimport { useParams, Link, useLocation, useNavigate } from \"react-router-dom\"\nimport { petService } from \"../services\"\nimport { useAuth } from \"../contexts/AuthContext\"\nimport { useApi } from \"../hooks\"\nimport { ArrowLeft, Utensils, Edit, Power, Trash2 } from \"lucide-react\"\nimport apiClient from \"../services/api\"\nimport VetNutritionForm from \"../components/VetNutritionForm\"\n\nconst NutritionRecommendation = () => {\n  const { petId } = useParams()\n  const { user } = useAuth()\n  const location = useLocation()\n  const navigate = useNavigate()\n  const [pet, setPet] = useState(null)\n  const [vetRecommendation, setVetRecommendation] = useState(null)\n  const [allPlans, setAllPlans] = useState([]) // plans for current pet\n  const [overviewPlans, setOverviewPlans] = useState([]) // plans for all pets (overview mode)\n  const [showVetForm, setShowVetForm] = useState(false)\n  const { loading, execute } = useApi()\n\n  useEffect(() => {\n    if (petId) {\n      fetchPetData()\n      fetchVetRecommendations()\n    } else {\n      // โหมดภาพรวม: ดึงแผนของสัตว์เลี้ยงทุกตัวของผู้ใช้\n      (async () => {\n        try {\n          const response = await apiClient.get('/nutrition/recommendations')\n          const plans = Array.isArray(response.data) ? response.data : []\n          setOverviewPlans(plans)\n        } catch (e) {\n          console.error('Failed to fetch overview nutrition plans:', e)\n        }\n      })()\n    }\n  }, [petId])\n\n  const fetchPetData = async () => {\n    const result = await execute(\n      () => petService.getPet(petId),\n      {\n        onSuccess: (result) => setPet(result.pet),\n        onError: (error) => console.error(\"Failed to fetch pet data:\", error)\n      }\n    )\n  }\n\n  const fetchVetRecommendations = async () => {\n    try {\n      console.log('[NR] petId:', petId)\n      \n      // สร้าง URL โดยไม่ส่ง pet_id ถ้าเป็น undefined\n      let url = '/nutrition/recommendations'\n      if (petId && petId !== 'undefined') {\n        url += `?pet_id=${petId}`\n      }\n      \n      const response = await apiClient.get(url)\n      console.log('[NR] response:', response.status, response.data)\n      const plans = Array.isArray(response.data) ? response.data : []\n      setAllPlans(plans)\n      \n      // อ่าน plan_id จาก query หากมี ให้ set เป็นรายการที่เลือก\n      const query = new URLSearchParams(location.search)\n      const planId = query.get('plan_id')\n      if (planId) {\n        const found = plans.find(p => p.id === planId)\n        if (found) setVetRecommendation(found)\n        else if (plans.length > 0) setVetRecommendation(plans[0])\n      } else if (plans.length > 0) {\n        setVetRecommendation(plans[0])\n      }\n    } catch (error) {\n      console.error(\"Failed to fetch vet recommendation:\", error)\n    }\n  }\n\n  // ตัดการใช้งาน AI recommendation ออกตามข้อกำหนดใหม่\n\n  const handleVetRecSaved = (savedRec) => {\n    setVetRecommendation(savedRec);\n    setShowVetForm(false);\n    // Refresh the plans list\n    fetchVetRecommendations();\n  }\n\n  const handleToggleStatus = async (planId) => {\n    try {\n      const response = await apiClient.patch(`/nutrition/recommendations/${planId}/toggle-status`);\n      // Update the plan in the list\n      setAllPlans(prevPlans => \n        prevPlans.map(plan => \n          plan.id === planId ? response.data : plan\n        )\n      );\n      // If this is the currently selected plan, update it too\n      if (vetRecommendation?.id === planId) {\n        setVetRecommendation(response.data);\n      }\n    } catch (error) {\n      console.error(\"Failed to toggle plan status:\", error);\n      // Show error message to user\n      const errorMessage = error.response?.data?.error || \"ไม่สามารถเปลี่ยนสถานะแผนได้\";\n      alert(errorMessage);\n    }\n  }\n\n  const handleDeletePlan = async (planId) => {\n    if (!window.confirm(\"คุณแน่ใจหรือไม่ที่จะลบแผนโภชนาการนี้?\")) {\n      return;\n    }\n    \n    try {\n      await apiClient.delete(`/nutrition/recommendations/${planId}`);\n      // Remove the plan from the list\n      setAllPlans(prevPlans => prevPlans.filter(plan => plan.id !== planId));\n      // If this was the currently selected plan, clear it\n      if (vetRecommendation?.id === planId) {\n        setVetRecommendation(null);\n      }\n    } catch (error) {\n      console.error(\"Failed to delete plan:\", error);\n      // Show error message to user\n      const errorMessage = error.response?.data?.error || \"ไม่สามารถลบแผนได้\";\n      alert(errorMessage);\n    }\n  }\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <div className=\"animate-spin rounded-full h-32 w-32 border-b-2 border-green-500\"></div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 py-8\">\n      <div className=\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8\">\n        {/* Back Button (เฉพาะโหมดดูรายตัว) */}\n        {petId && (\n        <Link\n          to={`/pets/${petId}`}\n          className=\"inline-flex items-center space-x-2 text-green-500 hover:text-green-600 mb-8\"\n        >\n          <ArrowLeft className=\"h-4 w-4\" />\n          <span>กลับไปหน้าสัตว์เลี้ยง</span>\n        </Link>\n        )}\n\n        {/* Header */}\n        <div className=\"card mb-8\">\n          <div className=\"flex items-center space-x-4\">\n            <div className=\"w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center\">\n              <Utensils className=\"h-8 w-8 text-orange-500\" />\n            </div>\n            <div>\n              <h1 className=\"text-3xl font-bold text-gray-900\">คำแนะนำโภชนาการ</h1>\n              {petId ? (\n              <p className=\"text-gray-600\">สำหรับ {pet?.name}</p>\n              ) : (\n                <p className=\"text-gray-600\">รวมทุกตัวของฉัน</p>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* โหมดภาพรวม: ไม่มี petId แสดงแผนทั้งหมดของผู้ใช้ */}\n        {!petId && (\n          <div className=\"card\">\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">แผนโภชนาการทั้งหมดของฉัน</h3>\n            {overviewPlans.length === 0 ? (\n              <p className=\"text-gray-600\">ยังไม่มีแผนโภชนาการ</p>\n            ) : (\n              <div className=\"space-y-3\">\n                {overviewPlans.map(plan => (\n                  <div key={plan.id} className=\"p-4 rounded border border-gray-200\">\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <div className=\"font-medium\">{plan.pets?.name || 'ไม่ทราบชื่อ'}</div>\n                      <span className={`text-xs px-2 py-0.5 rounded ${plan.is_active ? 'bg-green-100 text-green-700' : 'bg-gray-100 text-gray-600'}`}>{plan.is_active ? 'Active' : 'Inactive'}</span>\n                    </div>\n                    <div className=\"text-sm text-gray-600 mb-2\">\n                      <p><strong>สัตวแพทย์:</strong> {plan.veterinarian?.full_name || 'ไม่ระบุ'}</p>\n                      <p><strong>สัตว์เลี้ยง:</strong> {plan.pets?.species} - {plan.pets?.breed || 'ไม่ระบุพันธุ์'}</p>\n                    </div>\n                    {plan.custom_calories && (\n                      <div className=\"text-sm text-gray-600 mt-1\">แคลอรี่/วัน: {plan.custom_calories}</div>\n                    )}\n                    <div className=\"mt-3\">\n                      <button\n                        className=\"btn-secondary btn-sm\"\n                        onClick={() => navigate(`/pets/${plan.pet_id}/nutrition?plan_id=${plan.id}`)}\n                      >\n                        ดูรายละเอียด\n                      </button>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n        )}\n\n        {/* โหมดรายตัว: มี petId จึงแสดง Sidebar รายการแผนของสัตว์เลี้ยงนั้น และรายละเอียดแผนที่เลือก */}\n        {petId && (\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n          <div className=\"card md:col-span-1\">\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-1\">แผนทั้งหมดของ</h3>\n            <p className=\"text-sm text-gray-600 mb-3\">{pet?.name || 'สัตว์เลี้ยงนี้'}</p>\n            {allPlans.length === 0 ? (\n              <p className=\"text-gray-500\">ยังไม่มีแผน</p>\n            ) : (\n              <div className=\"space-y-2\">\n                {allPlans.map(plan => (\n                  <div\n                    key={plan.id}\n                    className={`w-full p-3 rounded border ${vetRecommendation?.id === plan.id ? 'border-green-500 bg-green-50' : 'border-gray-200'}`}\n                  >\n                    <button\n                      onClick={() => {\n                        setVetRecommendation(plan)\n                        navigate({ pathname: `/pets/${petId}/nutrition`, search: `?plan_id=${plan.id}` })\n                      }}\n                      className=\"w-full text-left\"\n                    >\n                      <div className=\"flex items-center justify-between\">\n                        <span className=\"font-medium\">{plan.is_active ? 'แผนปัจจุบัน' : 'แผนก่อนหน้า'}</span>\n                        <span className={`text-xs px-2 py-0.5 rounded ${plan.is_active ? 'bg-green-100 text-green-700' : 'bg-gray-100 text-gray-600'}`}>{plan.is_active ? 'Active' : 'Inactive'}</span>\n                      </div>\n                      <div className=\"text-sm text-gray-600 mt-1\">แคลอรี่/วัน: {plan.custom_calories ?? '-'}</div>\n                      <div className=\"text-xs text-gray-500\">เริ่ม: {new Date(plan.start_date).toLocaleDateString('th-TH')}</div>\n                    </button>\n                    \n                    {/* ปุ่มจัดการสำหรับสัตวแพทย์ */}\n                    {user?.role === 'veterinarian' && (\n                      <div className=\"flex items-center justify-end space-x-2 mt-2 pt-2 border-t border-gray-200\">\n                        <button\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            handleToggleStatus(plan.id);\n                          }}\n                          className={`text-xs px-2 py-1 rounded flex items-center space-x-1 ${\n                            plan.is_active \n                              ? 'text-orange-600 hover:bg-orange-50' \n                              : 'text-green-600 hover:bg-green-50'\n                          }`}\n                          title={plan.is_active ? 'ปิดใช้งาน' : 'เปิดใช้งาน'}\n                        >\n                          <Power size={12} />\n                          <span>{plan.is_active ? 'ปิด' : 'เปิด'}</span>\n                        </button>\n                        <button\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            handleDeletePlan(plan.id);\n                          }}\n                          className=\"text-xs px-2 py-1 rounded text-red-600 hover:bg-red-50 flex items-center space-x-1\"\n                          title=\"ลบแผน\"\n                        >\n                          <Trash2 size={12} />\n                          <span>ลบ</span>\n                        </button>\n                      </div>\n                    )}\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n\n          <div className=\"md:col-span-2\">\n            {vetRecommendation ? (\n            <div className=\"card border-l-4 border-green-500\">\n                <div className=\"flex justify-between items-start\">\n                    <div>\n                    <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">รายละเอียดคำแนะนำจากสัตวแพทย์</h3>\n                    <div className=\"mb-3 p-3 bg-gray-50 rounded-lg\">\n                      <p className=\"text-sm text-gray-600 mb-1\">\n                        <strong>สัตว์เลี้ยง:</strong> <span className=\"font-medium\">{vetRecommendation.pets?.name || 'ไม่ระบุ'}</span>\n                      </p>\n                      <p className=\"text-sm text-gray-600 mb-1\">\n                        <strong>สัตวแพทย์:</strong> <span className=\"font-medium\">{vetRecommendation.veterinarian?.full_name || 'ไม่ระบุ'}</span>\n                      </p>\n                      <p className=\"text-xs text-gray-500\">\n                        {vetRecommendation.pets?.species} - {vetRecommendation.pets?.breed || 'ไม่ระบุพันธุ์'} | \n                        น้ำหนัก: {vetRecommendation.pets?.weight ? `${vetRecommendation.pets.weight} กก.` : 'ไม่ระบุ'}\n                      </p>\n                    </div>\n                    <p className=\"text-gray-700 leading-relaxed whitespace-pre-line\">{vetRecommendation.custom_instructions}</p>\n                    {vetRecommendation.custom_calories && (\n                      <p className=\"text-gray-700 mt-3\">พลังงานแนะนำต่อวัน: <span className=\"font-medium\">{vetRecommendation.custom_calories}</span> kcal</p>\n                    )}\n                    </div>\n                    {user?.role === 'veterinarian' && !showVetForm && (\n                    <div className=\"flex space-x-2\">\n                        <button onClick={() => setShowVetForm(true)} className=\"btn-secondary btn-sm\">\n                            <Edit size={16} />\n                        </button>\n                    </div>\n                  )}\n                </div>\n              </div>\n            ) : (\n              <div className=\"card\"><p className=\"text-gray-600\">ยังไม่มีแผนที่เลือก</p></div>\n                    )}\n                </div>\n            </div>\n        )}\n\n        {/* Vet Form */}\n        {user?.role === 'veterinarian' && showVetForm && (\n            <VetNutritionForm\n                petId={petId || null}\n                existingRecommendation={vetRecommendation?.custom_instructions}\n                planId={vetRecommendation?.id}\n                onSave={handleVetRecSaved}\n                onCancel={() => setShowVetForm(false)}\n            />\n        )}\n\n        {/* ตัดส่วน AI recommendation ออกตามข้อกำหนดใหม่ */}\n\n        {/* Add Vet Recommendation Button */}\n        {user?.role === 'veterinarian' && !showVetForm && (\n             <div className=\"text-center mt-8\">\n                <button onClick={() => setShowVetForm(true)} className=\"btn-outline\">\n                    <Edit size={18} className=\"mr-2\" />\n                    {petId ? 'เพิ่มคำแนะนำจากสัตวแพทย์' : 'สร้างแผนโภชนาการใหม่'}\n                </button>\n            </div>\n        )}\n      </div>\n    </div>\n  )\n}\n\nexport default NutritionRecommendation\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}