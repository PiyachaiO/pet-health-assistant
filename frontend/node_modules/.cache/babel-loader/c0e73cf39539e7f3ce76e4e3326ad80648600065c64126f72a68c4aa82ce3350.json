{"ast":null,"code":"import{useState,useCallback}from'react';import{handleApiError}from'../services';export const useApi=()=>{const[loading,setLoading]=useState(false);const[error,setError]=useState(null);const execute=useCallback(async function(apiCall){let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const{showError=true,onSuccess,onError,resetError=true}=options;if(resetError){setError(null);}setLoading(true);try{const result=await apiCall();// ✅ **แก้ไขจุดนี้:** เพิ่มเงื่อนไข || Array.isArray(result)\n// เพื่อให้รองรับ API ที่คืนค่าเป็น Array ตรงๆ ได้\nif(result.success===true||Array.isArray(result)){if(onSuccess){onSuccess(result);}return result;}else{const errorMessage=result.error||'เกิดข้อผิดพลาด';setError(errorMessage);if(showError){handleApiError({response:{data:{message:errorMessage}}});}if(onError){onError(result);}return result;}}catch(err){const errorMessage=err.message||'เกิดข้อผิดพลาดที่ไม่ทราบสาเหตุ';setError(errorMessage);if(showError){handleApiError(err);}if(onError){onError(err);}return{success:false,error:errorMessage};}finally{setLoading(false);}},[]);const resetError=useCallback(()=>{setError(null);},[]);return{loading,error,execute,resetError};};","map":{"version":3,"names":["useState","useCallback","handleApiError","useApi","loading","setLoading","error","setError","execute","apiCall","options","arguments","length","undefined","showError","onSuccess","onError","resetError","result","success","Array","isArray","errorMessage","response","data","message","err"],"sources":["D:/senior.project/pet-health-docs/frontend/src/hooks/useApi.js"],"sourcesContent":["import { useState, useCallback } from 'react';\r\nimport { handleApiError } from '../services';\r\n\r\nexport const useApi = () => {\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n\r\n  const execute = useCallback(async (apiCall, options = {}) => {\r\n    const { \r\n      showError = true, \r\n      onSuccess, \r\n      onError, \r\n      resetError = true \r\n    } = options;\r\n\r\n    if (resetError) {\r\n      setError(null);\r\n    }\r\n    \r\n    setLoading(true);\r\n\r\n    try {\r\n      const result = await apiCall();\r\n      \r\n      // ✅ **แก้ไขจุดนี้:** เพิ่มเงื่อนไข || Array.isArray(result)\r\n      // เพื่อให้รองรับ API ที่คืนค่าเป็น Array ตรงๆ ได้\r\n      if (result.success === true || Array.isArray(result)) {\r\n        if (onSuccess) {\r\n          onSuccess(result);\r\n        }\r\n        return result;\r\n      } else {\r\n        const errorMessage = result.error || 'เกิดข้อผิดพลาด';\r\n        setError(errorMessage);\r\n        \r\n        if (showError) {\r\n          handleApiError({ response: { data: { message: errorMessage } } });\r\n        }\r\n        \r\n        if (onError) {\r\n          onError(result);\r\n        }\r\n        \r\n        return result;\r\n      }\r\n    } catch (err) {\r\n      const errorMessage = err.message || 'เกิดข้อผิดพลาดที่ไม่ทราบสาเหตุ';\r\n      setError(errorMessage);\r\n      \r\n      if (showError) {\r\n        handleApiError(err);\r\n      }\r\n      \r\n      if (onError) {\r\n        onError(err);\r\n      }\r\n      \r\n      return { success: false, error: errorMessage };\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  const resetError = useCallback(() => {\r\n    setError(null);\r\n  }, []);\r\n\r\n  return {\r\n    loading,\r\n    error,\r\n    execute,\r\n    resetError,\r\n  };\r\n};"],"mappings":"AAAA,OAASA,QAAQ,CAAEC,WAAW,KAAQ,OAAO,CAC7C,OAASC,cAAc,KAAQ,aAAa,CAE5C,MAAO,MAAM,CAAAC,MAAM,CAAGA,CAAA,GAAM,CAC1B,KAAM,CAACC,OAAO,CAAEC,UAAU,CAAC,CAAGL,QAAQ,CAAC,KAAK,CAAC,CAC7C,KAAM,CAACM,KAAK,CAAEC,QAAQ,CAAC,CAAGP,QAAQ,CAAC,IAAI,CAAC,CAExC,KAAM,CAAAQ,OAAO,CAAGP,WAAW,CAAC,eAAOQ,OAAO,CAAmB,IAAjB,CAAAC,OAAO,CAAAC,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,CAAC,CAAC,CACtD,KAAM,CACJG,SAAS,CAAG,IAAI,CAChBC,SAAS,CACTC,OAAO,CACPC,UAAU,CAAG,IACf,CAAC,CAAGP,OAAO,CAEX,GAAIO,UAAU,CAAE,CACdV,QAAQ,CAAC,IAAI,CAAC,CAChB,CAEAF,UAAU,CAAC,IAAI,CAAC,CAEhB,GAAI,CACF,KAAM,CAAAa,MAAM,CAAG,KAAM,CAAAT,OAAO,CAAC,CAAC,CAE9B;AACA;AACA,GAAIS,MAAM,CAACC,OAAO,GAAK,IAAI,EAAIC,KAAK,CAACC,OAAO,CAACH,MAAM,CAAC,CAAE,CACpD,GAAIH,SAAS,CAAE,CACbA,SAAS,CAACG,MAAM,CAAC,CACnB,CACA,MAAO,CAAAA,MAAM,CACf,CAAC,IAAM,CACL,KAAM,CAAAI,YAAY,CAAGJ,MAAM,CAACZ,KAAK,EAAI,gBAAgB,CACrDC,QAAQ,CAACe,YAAY,CAAC,CAEtB,GAAIR,SAAS,CAAE,CACbZ,cAAc,CAAC,CAAEqB,QAAQ,CAAE,CAAEC,IAAI,CAAE,CAAEC,OAAO,CAAEH,YAAa,CAAE,CAAE,CAAC,CAAC,CACnE,CAEA,GAAIN,OAAO,CAAE,CACXA,OAAO,CAACE,MAAM,CAAC,CACjB,CAEA,MAAO,CAAAA,MAAM,CACf,CACF,CAAE,MAAOQ,GAAG,CAAE,CACZ,KAAM,CAAAJ,YAAY,CAAGI,GAAG,CAACD,OAAO,EAAI,gCAAgC,CACpElB,QAAQ,CAACe,YAAY,CAAC,CAEtB,GAAIR,SAAS,CAAE,CACbZ,cAAc,CAACwB,GAAG,CAAC,CACrB,CAEA,GAAIV,OAAO,CAAE,CACXA,OAAO,CAACU,GAAG,CAAC,CACd,CAEA,MAAO,CAAEP,OAAO,CAAE,KAAK,CAAEb,KAAK,CAAEgB,YAAa,CAAC,CAChD,CAAC,OAAS,CACRjB,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAY,UAAU,CAAGhB,WAAW,CAAC,IAAM,CACnCM,QAAQ,CAAC,IAAI,CAAC,CAChB,CAAC,CAAE,EAAE,CAAC,CAEN,MAAO,CACLH,OAAO,CACPE,KAAK,CACLE,OAAO,CACPS,UACF,CAAC,CACH,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}