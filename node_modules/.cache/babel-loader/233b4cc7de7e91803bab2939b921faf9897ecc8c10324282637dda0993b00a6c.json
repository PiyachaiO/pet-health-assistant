{"ast":null,"code":"\"use client\";import{useState,useEffect}from\"react\";import{useAuth}from\"../contexts/AuthContext\";import apiClient from\"../services/api\";import{Calendar,Clock,User,Plus,CheckCircle,XCircle}from\"lucide-react\";import BookAppointmentModal from\"../components/BookAppointmentModal\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Appointments=()=>{var _selectedAppointment$,_selectedAppointment$2,_selectedAppointment$3,_selectedAppointment$4,_selectedAppointment$5,_selectedAppointment$6,_selectedAppointment$7,_selectedAppointment$8,_selectedAppointment$9,_selectedAppointment$0,_selectedAppointment$1,_selectedAppointment$10,_selectedAppointment$11,_selectedAppointment$12,_selectedAppointment$13,_selectedAppointment$14,_selectedAppointment$15,_selectedAppointment$16,_selectedAppointment$17,_selectedAppointment$18;const{user}=useAuth();const[appointments,setAppointments]=useState([]);const[loading,setLoading]=useState(true);const[showBookModal,setShowBookModal]=useState(false);const[selectedAppointment,setSelectedAppointment]=useState(null);const[showDetailModal,setShowDetailModal]=useState(false);const[showApprovalModal,setShowApprovalModal]=useState(false);const[approvalAction,setApprovalAction]=useState(\"\");const[rejectionReason,setRejectionReason]=useState(\"\");const[processingApproval,setProcessingApproval]=useState(false);const[userImages,setUserImages]=useState({});useEffect(()=>{fetchAppointments();},[]);// Load user images when appointments data changes\nuseEffect(()=>{if(appointments.length>0){loadUserImages();}},[appointments]);const loadUserImages=async()=>{const imagePromises=appointments.map(async appointment=>{var _appointment$user,_appointment$user2;if((_appointment$user=appointment.user)!==null&&_appointment$user!==void 0&&_appointment$user.profile_picture_url&&!appointment.user.profile_picture_url.startsWith('data:')){try{const filename=appointment.user.profile_picture_url.includes('/')?appointment.user.profile_picture_url.split('/').pop():appointment.user.profile_picture_url;const response=await fetch(`${process.env.REACT_APP_API_URL}/upload/image/${filename}`,{mode:'cors',credentials:'omit'});if(response.ok){const blob=await response.blob();const reader=new FileReader();const base64Image=await new Promise(resolve=>{reader.onload=e=>resolve(e.target.result);reader.readAsDataURL(blob);});return{userId:appointment.user.id,image:base64Image};}}catch(error){console.error(`Failed to load image for user ${appointment.user.id}:`,error);}}return{userId:(_appointment$user2=appointment.user)===null||_appointment$user2===void 0?void 0:_appointment$user2.id,image:null};});const results=await Promise.all(imagePromises);const imageMap={};results.forEach(_ref=>{let{userId,image}=_ref;if(userId&&image){imageMap[userId]=image;}});setUserImages(imageMap);};const fetchAppointments=async()=>{try{let endpoint=\"/appointments\";// กำหนด endpoint ตาม role\nif((user===null||user===void 0?void 0:user.role)===\"veterinarian\"){endpoint=\"/appointments/vet\";}else if((user===null||user===void 0?void 0:user.role)===\"admin\"){// แอดมินดูการนัดหมายทั้งหมด (ใช้ vet endpoint เพื่อดูทั้งหมด)\nendpoint=\"/appointments/vet\";}const response=await apiClient.get(endpoint);setAppointments(response.data);}catch(error){console.error(\"Failed to fetch appointments:\",error);}finally{setLoading(false);}};const handleAppointmentBooked=newAppointment=>{setAppointments([...appointments,newAppointment]);setShowBookModal(false);};const[updatingStatus,setUpdatingStatus]=useState(new Set());const handleUpdateStatus=async(id,status)=>{// ป้องกันการคลิกซ้ำ\nif(updatingStatus.has(id)){return;}setUpdatingStatus(prev=>new Set(prev).add(id));try{const response=await apiClient.patch(`/appointments/${id}/status`,{status});// Update the appointment in the list\nsetAppointments(appointments.map(app=>app.id===id?response.data:app));}catch(error){var _error$response;console.error(`Failed to update appointment status to ${status}:`,error);// แสดง error message ที่เป็นมิตรกับผู้ใช้\nif(((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status)===429){alert('กรุณารอสักครู่แล้วลองใหม่อีกครั้ง (ระบบกำลังประมวลผล)');}else{alert('ไม่สามารถอัปเดตสถานะได้ กรุณาลองใหม่อีกครั้ง');}}finally{setUpdatingStatus(prev=>{const newSet=new Set(prev);newSet.delete(id);return newSet;});}};const getStatusColor=status=>{switch(status){case\"scheduled\":return\"bg-blue-100 text-blue-800\";case\"confirmed\":return\"bg-green-100 text-green-800\";case\"completed\":return\"bg-gray-100 text-gray-800\";case\"cancelled\":return\"bg-red-100 text-red-800\";default:return\"bg-gray-100 text-gray-800\";}};const getStatusText=status=>{switch(status){case\"scheduled\":return\"รอยืนยัน\";case\"confirmed\":return\"ยืนยันแล้ว\";case\"completed\":return\"เสร็จสิ้น\";case\"cancelled\":return\"ยกเลิก\";default:return status;}};const getAppointmentTypeText=type=>{switch(type){case\"checkup\":return\"ตรวจสุขภาพทั่วไป\";case\"vaccination\":return\"ฉีดวัคซีน\";case\"consultation\":return\"ปรึกษาปัญหา\";case\"surgery\":return\"ผ่าตัด\";case\"emergency\":return\"ฉุกเฉิน\";default:return type;}};const formatDateTime=dateString=>{return new Date(dateString).toLocaleString(\"th-TH\",{year:\"numeric\",month:\"short\",day:\"numeric\",hour:\"2-digit\",minute:\"2-digit\"});};const handleApprovalAction=(appointment,action)=>{setSelectedAppointment(appointment);setApprovalAction(action);setRejectionReason(\"\");setShowApprovalModal(true);};const processApproval=async()=>{if(!selectedAppointment)return;setProcessingApproval(true);try{const endpoint=`/admin/appointments/${selectedAppointment.id}/approve`;const payload={action:approvalAction,rejection_reason:approvalAction===\"reject\"?rejectionReason:null};await apiClient.patch(endpoint,payload);// อัพเดทข้อมูลในหน้า\nsetAppointments(appointments.filter(a=>a.id!==selectedAppointment.id));setShowApprovalModal(false);setSelectedAppointment(null);alert(`${approvalAction===\"approve\"?\"อนุมัติ\":\"ปฏิเสธ\"}สำเร็จแล้ว`);}catch(error){var _error$response2,_error$response2$data;console.error(\"Failed to process approval:\",error);alert(`เกิดข้อผิดพลาด: ${((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.error)||error.message}`);}finally{setProcessingApproval(false);}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-32 w-32 border-b-2 border-green-500\"})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gray-50 py-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-8\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-gray-900\",children:\"\\u0E01\\u0E32\\u0E23\\u0E19\\u0E31\\u0E14\\u0E2B\\u0E21\\u0E32\\u0E22\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mt-2\",children:(user===null||user===void 0?void 0:user.role)===\"veterinarian\"?\"จัดการนัดหมายของสัตวแพทย์\":(user===null||user===void 0?void 0:user.role)===\"admin\"?\"ดูการนัดหมายทั้งหมดในระบบ\":\"จัดการนัดหมายกับสัตวแพทย์\"})]}),(user===null||user===void 0?void 0:user.role)!==\"admin\"&&/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowBookModal(true),className:\"btn-primary flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(Plus,{className:\"h-4 w-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0E08\\u0E2D\\u0E07\\u0E19\\u0E31\\u0E14\\u0E2B\\u0E21\\u0E32\\u0E22\"})]})]}),appointments.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"card text-center py-12\",children:[/*#__PURE__*/_jsx(Calendar,{className:\"h-16 w-16 text-gray-300 mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900 mb-2\",children:\"\\u0E22\\u0E31\\u0E07\\u0E44\\u0E21\\u0E48\\u0E21\\u0E35\\u0E01\\u0E32\\u0E23\\u0E19\\u0E31\\u0E14\\u0E2B\\u0E21\\u0E32\\u0E22\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-4\",children:(user===null||user===void 0?void 0:user.role)===\"veterinarian\"?\"ยังไม่มีนัดหมายที่ต้องดูแล\":(user===null||user===void 0?void 0:user.role)===\"admin\"?\"ยังไม่มีการนัดหมายในระบบ\":\"จองนัดหมายกับสัตวแพทย์เพื่อดูแลสุขภาพสัตว์เลี้ยงของคุณ\"}),(user===null||user===void 0?void 0:user.role)!==\"admin\"&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowBookModal(true),className:\"btn-primary\",children:\"\\u0E08\\u0E2D\\u0E07\\u0E19\\u0E31\\u0E14\\u0E2B\\u0E21\\u0E32\\u0E22\\u0E41\\u0E23\\u0E01\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:appointments.map(appointment=>{var _appointment$user3,_appointment$user4,_appointment$user5,_appointment$user6,_appointment$user7,_appointment$user8,_appointment$user9,_appointment$user0,_appointment$pets,_appointment$pets2,_appointment$veterina,_appointment$veterina2;return/*#__PURE__*/_jsx(\"div\",{className:`border rounded-lg p-4 ${appointment.status===\"scheduled\"?\"bg-orange-50\":appointment.status===\"confirmed\"?\"bg-green-50\":appointment.status===\"completed\"?\"bg-gray-50\":appointment.status===\"cancelled\"?\"bg-red-50\":\"bg-gray-50\"}`,children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2 mb-2\",children:[/*#__PURE__*/_jsx(Calendar,{className:\"h-4 w-4 text-blue-500\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-900\",children:getAppointmentTypeText(appointment.appointment_type)}),/*#__PURE__*/_jsx(\"span\",{className:`px-2 py-1 text-xs rounded-full ${appointment.status===\"scheduled\"?\"bg-orange-100 text-orange-800\":appointment.status===\"confirmed\"?\"bg-green-100 text-green-800\":appointment.status===\"completed\"?\"bg-gray-100 text-gray-800\":appointment.status===\"cancelled\"?\"bg-red-100 text-red-800\":\"bg-gray-100 text-gray-800\"}`,children:getStatusText(appointment.status)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid md:grid-cols-2 gap-4 text-sm text-gray-600\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2 mb-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-6 h-6 bg-gray-200 rounded-full flex items-center justify-center overflow-hidden\",children:[userImages[(_appointment$user3=appointment.user)===null||_appointment$user3===void 0?void 0:_appointment$user3.id]||(_appointment$user4=appointment.user)!==null&&_appointment$user4!==void 0&&_appointment$user4.profile_picture_url&&appointment.user.profile_picture_url.startsWith('data:')?/*#__PURE__*/_jsx(\"img\",{src:userImages[(_appointment$user5=appointment.user)===null||_appointment$user5===void 0?void 0:_appointment$user5.id]||appointment.user.profile_picture_url,alt:(_appointment$user6=appointment.user)===null||_appointment$user6===void 0?void 0:_appointment$user6.full_name,className:\"w-full h-full object-cover\",onError:e=>{e.target.style.display='none';e.target.nextSibling.style.display='flex';}}):null,/*#__PURE__*/_jsx(\"div\",{className:`w-full h-full flex items-center justify-center ${userImages[(_appointment$user7=appointment.user)===null||_appointment$user7===void 0?void 0:_appointment$user7.id]||(_appointment$user8=appointment.user)!==null&&_appointment$user8!==void 0&&_appointment$user8.profile_picture_url&&appointment.user.profile_picture_url.startsWith('data:')?'hidden':'flex'}`,children:/*#__PURE__*/_jsx(\"svg\",{className:\"h-3 w-3 text-gray-400\",fill:\"currentColor\",viewBox:\"0 0 20 20\",children:/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\",clipRule:\"evenodd\"})})})]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0E40\\u0E08\\u0E49\\u0E32\\u0E02\\u0E2D\\u0E07:\"}),\" \",((_appointment$user9=appointment.user)===null||_appointment$user9===void 0?void 0:_appointment$user9.full_name)||((_appointment$user0=appointment.user)===null||_appointment$user0===void 0?void 0:_appointment$user0.email)||'ไม่ระบุ']})]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0E2A\\u0E31\\u0E15\\u0E27\\u0E4C\\u0E40\\u0E25\\u0E35\\u0E49\\u0E22\\u0E07:\"}),\" \",((_appointment$pets=appointment.pets)===null||_appointment$pets===void 0?void 0:_appointment$pets.name)||'ไม่ระบุ',\" (\",((_appointment$pets2=appointment.pets)===null||_appointment$pets2===void 0?void 0:_appointment$pets2.species)||'ไม่ระบุ',\")\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0E2A\\u0E31\\u0E15\\u0E27\\u0E41\\u0E1E\\u0E17\\u0E22\\u0E4C:\"}),\" \",((_appointment$veterina=appointment.veterinarian)===null||_appointment$veterina===void 0?void 0:_appointment$veterina.full_name)||((_appointment$veterina2=appointment.veterinarian)===null||_appointment$veterina2===void 0?void 0:_appointment$veterina2.email)||'ไม่ระบุ']})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0E27\\u0E31\\u0E19\\u0E17\\u0E35\\u0E48:\"}),\" \",formatDateTime(appointment.appointment_date)]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0E2A\\u0E23\\u0E49\\u0E32\\u0E07\\u0E40\\u0E21\\u0E37\\u0E48\\u0E2D:\"}),\" \",formatDateTime(appointment.created_at)]})]})]}),appointment.notes&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-3 p-3 bg-gray-50 rounded-md\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-700\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0E2B\\u0E21\\u0E32\\u0E22\\u0E40\\u0E2B\\u0E15\\u0E38:\"}),\" \",appointment.notes]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col space-y-2 ml-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setSelectedAppointment(appointment);setShowDetailModal(true);},className:\"text-blue-600 hover:text-blue-800 text-sm font-medium\",children:\"\\u0E14\\u0E39\\u0E23\\u0E32\\u0E22\\u0E25\\u0E30\\u0E40\\u0E2D\\u0E35\\u0E22\\u0E14\"}),appointment.status===\"scheduled\"&&(user===null||user===void 0?void 0:user.role)===\"admin\"&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleApprovalAction(appointment,\"approve\"),className:\"flex items-center space-x-1 bg-green-500 text-white px-3 py-1 rounded-md text-sm hover:bg-green-600\",children:[/*#__PURE__*/_jsx(CheckCircle,{className:\"h-4 w-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0E2D\\u0E19\\u0E38\\u0E21\\u0E31\\u0E15\\u0E34\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleApprovalAction(appointment,\"reject\"),className:\"flex items-center space-x-1 bg-red-500 text-white px-3 py-1 rounded-md text-sm hover:bg-red-600\",children:[/*#__PURE__*/_jsx(XCircle,{className:\"h-4 w-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u0E1B\\u0E0F\\u0E34\\u0E40\\u0E2A\\u0E18\"})]})]}),appointment.status===\"scheduled\"&&(user===null||user===void 0?void 0:user.role)!==\"admin\"&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleUpdateStatus(appointment.id,'confirmed'),disabled:updatingStatus.has(appointment.id),className:`text-green-600 hover:text-green-700 ${updatingStatus.has(appointment.id)?'opacity-50 cursor-not-allowed':''}`,title:\"\\u0E22\\u0E37\\u0E19\\u0E22\\u0E31\\u0E19\\u0E19\\u0E31\\u0E14\\u0E2B\\u0E21\\u0E32\\u0E22\",children:/*#__PURE__*/_jsx(CheckCircle,{className:\"h-5 w-5\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleUpdateStatus(appointment.id,'cancelled'),disabled:updatingStatus.has(appointment.id),className:`text-red-600 hover:text-red-700 ${updatingStatus.has(appointment.id)?'opacity-50 cursor-not-allowed':''}`,title:\"\\u0E22\\u0E01\\u0E40\\u0E25\\u0E34\\u0E01\\u0E19\\u0E31\\u0E14\\u0E2B\\u0E21\\u0E32\\u0E22\",children:/*#__PURE__*/_jsx(XCircle,{className:\"h-5 w-5\"})})]})]})]})},appointment.id);})})]}),showBookModal&&/*#__PURE__*/_jsx(BookAppointmentModal,{onClose:()=>setShowBookModal(false),onAppointmentBooked:handleAppointmentBooked}),showDetailModal&&selectedAppointment&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl max-w-md w-full\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-6 border-b\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-900\",children:\"\\u0E23\\u0E32\\u0E22\\u0E25\\u0E30\\u0E40\\u0E2D\\u0E35\\u0E22\\u0E14\\u0E19\\u0E31\\u0E14\\u0E2B\\u0E21\\u0E32\\u0E22\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowDetailModal(false),className:\"text-gray-400 hover:text-gray-600\",children:/*#__PURE__*/_jsx(XCircle,{className:\"h-6 w-6\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-700\",children:\"\\u0E2A\\u0E31\\u0E15\\u0E27\\u0E4C\\u0E40\\u0E25\\u0E35\\u0E49\\u0E22\\u0E07\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-900\",children:((_selectedAppointment$=selectedAppointment.pets)===null||_selectedAppointment$===void 0?void 0:_selectedAppointment$.name)||'ไม่ระบุ'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-700\",children:\"\\u0E1B\\u0E23\\u0E30\\u0E40\\u0E20\\u0E17\\u0E2A\\u0E31\\u0E15\\u0E27\\u0E4C\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-900\",children:[((_selectedAppointment$2=selectedAppointment.pets)===null||_selectedAppointment$2===void 0?void 0:_selectedAppointment$2.species)||'ไม่ระบุ',\" - \",((_selectedAppointment$3=selectedAppointment.pets)===null||_selectedAppointment$3===void 0?void 0:_selectedAppointment$3.breed)||'ไม่ระบุ']})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-700\",children:\"\\u0E2A\\u0E35\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-900\",children:((_selectedAppointment$4=selectedAppointment.pets)===null||_selectedAppointment$4===void 0?void 0:_selectedAppointment$4.color)||'ไม่ระบุ'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-700\",children:\"\\u0E19\\u0E49\\u0E33\\u0E2B\\u0E19\\u0E31\\u0E01\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-900\",children:(_selectedAppointment$5=selectedAppointment.pets)!==null&&_selectedAppointment$5!==void 0&&_selectedAppointment$5.weight?`${selectedAppointment.pets.weight} กก.`:'ไม่ระบุ'})]})]}),((user===null||user===void 0?void 0:user.role)===\"veterinarian\"||(user===null||user===void 0?void 0:user.role)===\"admin\")&&selectedAppointment.user&&/*#__PURE__*/_jsx(\"div\",{className:\"border-t pt-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center overflow-hidden\",children:[(_selectedAppointment$6=selectedAppointment.user)!==null&&_selectedAppointment$6!==void 0&&_selectedAppointment$6.profile_picture_url?/*#__PURE__*/_jsx(\"img\",{src:selectedAppointment.user.profile_picture_url,alt:(_selectedAppointment$7=selectedAppointment.user)===null||_selectedAppointment$7===void 0?void 0:_selectedAppointment$7.full_name,className:\"w-full h-full object-cover\",onError:e=>{e.target.style.display='none';e.target.nextSibling.style.display='flex';}}):null,/*#__PURE__*/_jsx(\"div\",{className:`w-full h-full flex items-center justify-center ${(_selectedAppointment$8=selectedAppointment.user)!==null&&_selectedAppointment$8!==void 0&&_selectedAppointment$8.profile_picture_url?'hidden':'flex'}`,children:/*#__PURE__*/_jsx(\"svg\",{className:\"h-5 w-5 text-gray-400\",fill:\"currentColor\",viewBox:\"0 0 20 20\",children:/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\",clipRule:\"evenodd\"})})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-700\",children:\"\\u0E40\\u0E08\\u0E49\\u0E32\\u0E02\\u0E2D\\u0E07\\u0E2A\\u0E31\\u0E15\\u0E27\\u0E4C\\u0E40\\u0E25\\u0E35\\u0E49\\u0E22\\u0E07\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-900\",children:((_selectedAppointment$9=selectedAppointment.user)===null||_selectedAppointment$9===void 0?void 0:_selectedAppointment$9.full_name)||((_selectedAppointment$0=selectedAppointment.user)===null||_selectedAppointment$0===void 0?void 0:_selectedAppointment$0.email)||'ไม่ระบุ'})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-t pt-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-700\",children:\"\\u0E2A\\u0E31\\u0E15\\u0E27\\u0E41\\u0E1E\\u0E17\\u0E22\\u0E4C\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-900\",children:((_selectedAppointment$1=selectedAppointment.veterinarian)===null||_selectedAppointment$1===void 0?void 0:_selectedAppointment$1.full_name)||((_selectedAppointment$10=selectedAppointment.veterinarian)===null||_selectedAppointment$10===void 0?void 0:_selectedAppointment$10.email)||'ไม่ระบุ'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-t pt-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-700\",children:\"\\u0E27\\u0E31\\u0E19\\u0E17\\u0E35\\u0E48\\u0E41\\u0E25\\u0E30\\u0E40\\u0E27\\u0E25\\u0E32\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-900\",children:new Date(selectedAppointment.appointment_date).toLocaleString('th-TH')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-t pt-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-700\",children:\"\\u0E1B\\u0E23\\u0E30\\u0E40\\u0E20\\u0E17\\u0E01\\u0E32\\u0E23\\u0E19\\u0E31\\u0E14\\u0E2B\\u0E21\\u0E32\\u0E22\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-900\",children:getAppointmentTypeText(selectedAppointment.appointment_type)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-t pt-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-700\",children:\"\\u0E2A\\u0E16\\u0E32\\u0E19\\u0E30\"}),/*#__PURE__*/_jsx(\"span\",{className:`px-3 py-1 rounded-full text-sm font-medium ${getStatusColor(selectedAppointment.status)}`,children:getStatusText(selectedAppointment.status)})]}),selectedAppointment.notes&&/*#__PURE__*/_jsxs(\"div\",{className:\"border-t pt-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-700\",children:\"\\u0E2B\\u0E21\\u0E32\\u0E22\\u0E40\\u0E2B\\u0E15\\u0E38\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-900\",children:selectedAppointment.notes})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-t pt-4 text-xs text-gray-500\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0E2A\\u0E23\\u0E49\\u0E32\\u0E07\\u0E40\\u0E21\\u0E37\\u0E48\\u0E2D: \",new Date(selectedAppointment.created_at).toLocaleString('th-TH')]}),selectedAppointment.updated_at&&selectedAppointment.updated_at!==selectedAppointment.created_at&&/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0E2D\\u0E31\\u0E1B\\u0E40\\u0E14\\u0E15\\u0E25\\u0E48\\u0E32\\u0E2A\\u0E38\\u0E14: \",new Date(selectedAppointment.updated_at).toLocaleString('th-TH')]})]})]})]})}),showApprovalModal&&selectedAppointment&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl max-w-md w-full\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-6 border-b\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-xl font-bold text-gray-900\",children:[approvalAction===\"approve\"?\"อนุมัติ\":\"ปฏิเสธ\",\"\\u0E01\\u0E32\\u0E23\\u0E19\\u0E31\\u0E14\\u0E2B\\u0E21\\u0E32\\u0E22\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowApprovalModal(false),className:\"text-gray-400 hover:text-gray-600\",children:/*#__PURE__*/_jsx(XCircle,{className:\"h-6 w-6\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium text-gray-900 mb-2\",children:\"\\u0E23\\u0E32\\u0E22\\u0E25\\u0E30\\u0E40\\u0E2D\\u0E35\\u0E22\\u0E14:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-600 space-y-1\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0E1B\\u0E23\\u0E30\\u0E40\\u0E20\\u0E17:\"}),\" \",getAppointmentTypeText(selectedAppointment.appointment_type)]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-5 h-5 bg-gray-200 rounded-full flex items-center justify-center overflow-hidden\",children:[(_selectedAppointment$11=selectedAppointment.user)!==null&&_selectedAppointment$11!==void 0&&_selectedAppointment$11.profile_picture_url?/*#__PURE__*/_jsx(\"img\",{src:selectedAppointment.user.profile_picture_url,alt:(_selectedAppointment$12=selectedAppointment.user)===null||_selectedAppointment$12===void 0?void 0:_selectedAppointment$12.full_name,className:\"w-full h-full object-cover\",onError:e=>{e.target.style.display='none';e.target.nextSibling.style.display='flex';}}):null,/*#__PURE__*/_jsx(\"div\",{className:`w-full h-full flex items-center justify-center ${(_selectedAppointment$13=selectedAppointment.user)!==null&&_selectedAppointment$13!==void 0&&_selectedAppointment$13.profile_picture_url?'hidden':'flex'}`,children:/*#__PURE__*/_jsx(\"svg\",{className:\"h-3 w-3 text-gray-400\",fill:\"currentColor\",viewBox:\"0 0 20 20\",children:/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\",clipRule:\"evenodd\"})})})]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0E40\\u0E08\\u0E49\\u0E32\\u0E02\\u0E2D\\u0E07:\"}),\" \",((_selectedAppointment$14=selectedAppointment.user)===null||_selectedAppointment$14===void 0?void 0:_selectedAppointment$14.full_name)||((_selectedAppointment$15=selectedAppointment.user)===null||_selectedAppointment$15===void 0?void 0:_selectedAppointment$15.email)||'ไม่ระบุ']})]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0E2A\\u0E31\\u0E15\\u0E27\\u0E4C\\u0E40\\u0E25\\u0E35\\u0E49\\u0E22\\u0E07:\"}),\" \",((_selectedAppointment$16=selectedAppointment.pets)===null||_selectedAppointment$16===void 0?void 0:_selectedAppointment$16.name)||'ไม่ระบุ']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0E2A\\u0E31\\u0E15\\u0E27\\u0E41\\u0E1E\\u0E17\\u0E22\\u0E4C:\"}),\" \",((_selectedAppointment$17=selectedAppointment.veterinarian)===null||_selectedAppointment$17===void 0?void 0:_selectedAppointment$17.full_name)||((_selectedAppointment$18=selectedAppointment.veterinarian)===null||_selectedAppointment$18===void 0?void 0:_selectedAppointment$18.email)||'ไม่ระบุ']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u0E27\\u0E31\\u0E19\\u0E17\\u0E35\\u0E48:\"}),\" \",formatDateTime(selectedAppointment.appointment_date)]})]})]}),approvalAction===\"reject\"&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"rejectionReason\",className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"\\u0E40\\u0E2B\\u0E15\\u0E38\\u0E1C\\u0E25\\u0E43\\u0E19\\u0E01\\u0E32\\u0E23\\u0E1B\\u0E0F\\u0E34\\u0E40\\u0E2A\\u0E18 *\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"rejectionReason\",rows:\"3\",className:\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500\",placeholder:\"\\u0E01\\u0E23\\u0E38\\u0E13\\u0E32\\u0E23\\u0E30\\u0E1A\\u0E38\\u0E40\\u0E2B\\u0E15\\u0E38\\u0E1C\\u0E25...\",value:rejectionReason,onChange:e=>setRejectionReason(e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowApprovalModal(false),className:\"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors\",children:\"\\u0E22\\u0E01\\u0E40\\u0E25\\u0E34\\u0E01\"}),/*#__PURE__*/_jsx(\"button\",{onClick:processApproval,disabled:processingApproval||approvalAction===\"reject\"&&!rejectionReason.trim(),className:`flex-1 px-4 py-2 rounded-lg text-white transition-colors disabled:opacity-50 disabled:cursor-not-allowed ${approvalAction===\"approve\"?\"bg-green-500 hover:bg-green-600\":\"bg-red-500 hover:bg-red-600\"}`,children:processingApproval?\"กำลังดำเนินการ...\":approvalAction===\"approve\"?\"อนุมัติ\":\"ปฏิเสธ\"})]})]})]})})]});};export default Appointments;","map":{"version":3,"names":["useState","useEffect","useAuth","apiClient","Calendar","Clock","User","Plus","CheckCircle","XCircle","BookAppointmentModal","jsx","_jsx","jsxs","_jsxs","Appointments","_selectedAppointment$","_selectedAppointment$2","_selectedAppointment$3","_selectedAppointment$4","_selectedAppointment$5","_selectedAppointment$6","_selectedAppointment$7","_selectedAppointment$8","_selectedAppointment$9","_selectedAppointment$0","_selectedAppointment$1","_selectedAppointment$10","_selectedAppointment$11","_selectedAppointment$12","_selectedAppointment$13","_selectedAppointment$14","_selectedAppointment$15","_selectedAppointment$16","_selectedAppointment$17","_selectedAppointment$18","user","appointments","setAppointments","loading","setLoading","showBookModal","setShowBookModal","selectedAppointment","setSelectedAppointment","showDetailModal","setShowDetailModal","showApprovalModal","setShowApprovalModal","approvalAction","setApprovalAction","rejectionReason","setRejectionReason","processingApproval","setProcessingApproval","userImages","setUserImages","fetchAppointments","length","loadUserImages","imagePromises","map","appointment","_appointment$user","_appointment$user2","profile_picture_url","startsWith","filename","includes","split","pop","response","fetch","process","env","REACT_APP_API_URL","mode","credentials","ok","blob","reader","FileReader","base64Image","Promise","resolve","onload","e","target","result","readAsDataURL","userId","id","image","error","console","results","all","imageMap","forEach","_ref","endpoint","role","get","data","handleAppointmentBooked","newAppointment","updatingStatus","setUpdatingStatus","Set","handleUpdateStatus","status","has","prev","add","patch","app","_error$response","alert","newSet","delete","getStatusColor","getStatusText","getAppointmentTypeText","type","formatDateTime","dateString","Date","toLocaleString","year","month","day","hour","minute","handleApprovalAction","action","processApproval","payload","rejection_reason","filter","a","_error$response2","_error$response2$data","message","className","children","onClick","_appointment$user3","_appointment$user4","_appointment$user5","_appointment$user6","_appointment$user7","_appointment$user8","_appointment$user9","_appointment$user0","_appointment$pets","_appointment$pets2","_appointment$veterina","_appointment$veterina2","appointment_type","src","alt","full_name","onError","style","display","nextSibling","fill","viewBox","fillRule","d","clipRule","email","pets","name","species","veterinarian","appointment_date","created_at","notes","disabled","title","onClose","onAppointmentBooked","breed","color","weight","updated_at","htmlFor","rows","placeholder","value","onChange","required","trim"],"sources":["D:/senior.project/pet-health-docs/src/pages/Appointments.js"],"sourcesContent":["\"use client\"\n\nimport { useState, useEffect } from \"react\"\nimport { useAuth } from \"../contexts/AuthContext\"\nimport apiClient from \"../services/api\"\nimport { Calendar, Clock, User, Plus, CheckCircle, XCircle } from \"lucide-react\"\nimport BookAppointmentModal from \"../components/BookAppointmentModal\"\n\nconst Appointments = () => {\n  const { user } = useAuth()\n  const [appointments, setAppointments] = useState([])\n  const [loading, setLoading] = useState(true)\n  const [showBookModal, setShowBookModal] = useState(false)\n  const [selectedAppointment, setSelectedAppointment] = useState(null)\n  const [showDetailModal, setShowDetailModal] = useState(false)\n  const [showApprovalModal, setShowApprovalModal] = useState(false)\n  const [approvalAction, setApprovalAction] = useState(\"\")\n  const [rejectionReason, setRejectionReason] = useState(\"\")\n  const [processingApproval, setProcessingApproval] = useState(false)\n  const [userImages, setUserImages] = useState({})\n\n  useEffect(() => {\n    fetchAppointments()\n  }, [])\n\n  // Load user images when appointments data changes\n  useEffect(() => {\n    if (appointments.length > 0) {\n      loadUserImages()\n    }\n  }, [appointments])\n\n  const loadUserImages = async () => {\n    const imagePromises = appointments.map(async (appointment) => {\n      if (appointment.user?.profile_picture_url && !appointment.user.profile_picture_url.startsWith('data:')) {\n        try {\n          const filename = appointment.user.profile_picture_url.includes('/') ? appointment.user.profile_picture_url.split('/').pop() : appointment.user.profile_picture_url\n          const response = await fetch(`${process.env.REACT_APP_API_URL}/upload/image/${filename}`, {\n            mode: 'cors',\n            credentials: 'omit'\n          })\n          if (response.ok) {\n            const blob = await response.blob()\n            const reader = new FileReader()\n            const base64Image = await new Promise((resolve) => {\n              reader.onload = (e) => resolve(e.target.result)\n              reader.readAsDataURL(blob)\n            })\n            return { userId: appointment.user.id, image: base64Image }\n          }\n        } catch (error) {\n          console.error(`Failed to load image for user ${appointment.user.id}:`, error)\n        }\n      }\n      return { userId: appointment.user?.id, image: null }\n    })\n\n    const results = await Promise.all(imagePromises)\n    const imageMap = {}\n    results.forEach(({ userId, image }) => {\n      if (userId && image) {\n        imageMap[userId] = image\n      }\n    })\n    setUserImages(imageMap)\n  }\n\n  const fetchAppointments = async () => {\n    try {\n      let endpoint = \"/appointments\"\n      \n      // กำหนด endpoint ตาม role\n      if (user?.role === \"veterinarian\") {\n        endpoint = \"/appointments/vet\"\n      } else if (user?.role === \"admin\") {\n        // แอดมินดูการนัดหมายทั้งหมด (ใช้ vet endpoint เพื่อดูทั้งหมด)\n        endpoint = \"/appointments/vet\"\n      }\n      \n      const response = await apiClient.get(endpoint)\n      setAppointments(response.data)\n    } catch (error) {\n      console.error(\"Failed to fetch appointments:\", error)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleAppointmentBooked = (newAppointment) => {\n    setAppointments([...appointments, newAppointment])\n    setShowBookModal(false)\n  }\n\n  const [updatingStatus, setUpdatingStatus] = useState(new Set());\n\n  const handleUpdateStatus = async (id, status) => {\n    // ป้องกันการคลิกซ้ำ\n    if (updatingStatus.has(id)) {\n      return;\n    }\n\n    setUpdatingStatus(prev => new Set(prev).add(id));\n    \n    try {\n      const response = await apiClient.patch(`/appointments/${id}/status`, { status });\n      // Update the appointment in the list\n      setAppointments(appointments.map(app => app.id === id ? response.data : app));\n    } catch (error) {\n      console.error(`Failed to update appointment status to ${status}:`, error);\n      \n      // แสดง error message ที่เป็นมิตรกับผู้ใช้\n      if (error.response?.status === 429) {\n        alert('กรุณารอสักครู่แล้วลองใหม่อีกครั้ง (ระบบกำลังประมวลผล)');\n      } else {\n        alert('ไม่สามารถอัปเดตสถานะได้ กรุณาลองใหม่อีกครั้ง');\n      }\n    } finally {\n      setUpdatingStatus(prev => {\n        const newSet = new Set(prev);\n        newSet.delete(id);\n        return newSet;\n      });\n    }\n  };\n\n  const getStatusColor = (status) => {\n    switch (status) {\n      case \"scheduled\":\n        return \"bg-blue-100 text-blue-800\"\n      case \"confirmed\":\n        return \"bg-green-100 text-green-800\"\n      case \"completed\":\n        return \"bg-gray-100 text-gray-800\"\n      case \"cancelled\":\n        return \"bg-red-100 text-red-800\"\n      default:\n        return \"bg-gray-100 text-gray-800\"\n    }\n  }\n\n  const getStatusText = (status) => {\n    switch (status) {\n      case \"scheduled\":\n        return \"รอยืนยัน\"\n      case \"confirmed\":\n        return \"ยืนยันแล้ว\"\n      case \"completed\":\n        return \"เสร็จสิ้น\"\n      case \"cancelled\":\n        return \"ยกเลิก\"\n      default:\n        return status\n    }\n  }\n\n  const getAppointmentTypeText = (type) => {\n    switch (type) {\n      case \"checkup\":\n        return \"ตรวจสุขภาพทั่วไป\";\n      case \"vaccination\":\n        return \"ฉีดวัคซีน\";\n      case \"consultation\":\n        return \"ปรึกษาปัญหา\";\n      case \"surgery\":\n        return \"ผ่าตัด\";\n      case \"emergency\":\n        return \"ฉุกเฉิน\";\n      default:\n        return type;\n    }\n  };\n\n  const formatDateTime = (dateString) => {\n    return new Date(dateString).toLocaleString(\"th-TH\", {\n      year: \"numeric\",\n      month: \"short\",\n      day: \"numeric\",\n      hour: \"2-digit\",\n      minute: \"2-digit\",\n    })\n  }\n\n  const handleApprovalAction = (appointment, action) => {\n    setSelectedAppointment(appointment)\n    setApprovalAction(action)\n    setRejectionReason(\"\")\n    setShowApprovalModal(true)\n  }\n\n  const processApproval = async () => {\n    if (!selectedAppointment) return\n\n    setProcessingApproval(true)\n    try {\n      const endpoint = `/admin/appointments/${selectedAppointment.id}/approve`\n      const payload = {\n        action: approvalAction,\n        rejection_reason: approvalAction === \"reject\" ? rejectionReason : null,\n      }\n\n      await apiClient.patch(endpoint, payload)\n\n      // อัพเดทข้อมูลในหน้า\n      setAppointments(appointments.filter((a) => a.id !== selectedAppointment.id))\n\n      setShowApprovalModal(false)\n      setSelectedAppointment(null)\n      alert(`${approvalAction === \"approve\" ? \"อนุมัติ\" : \"ปฏิเสธ\"}สำเร็จแล้ว`)\n    } catch (error) {\n      console.error(\"Failed to process approval:\", error)\n      alert(`เกิดข้อผิดพลาด: ${error.response?.data?.error || error.message}`)\n    } finally {\n      setProcessingApproval(false)\n    }\n  }\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <div className=\"animate-spin rounded-full h-32 w-32 border-b-2 border-green-500\"></div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 py-8\">\n      <div className=\"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8\">\n        {/* Header */}\n        <div className=\"flex justify-between items-center mb-8\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-gray-900\">การนัดหมาย</h1>\n            <p className=\"text-gray-600 mt-2\">\n              {user?.role === \"veterinarian\" \n                ? \"จัดการนัดหมายของสัตวแพทย์\" \n                : user?.role === \"admin\"\n                ? \"ดูการนัดหมายทั้งหมดในระบบ\"\n                : \"จัดการนัดหมายกับสัตวแพทย์\"\n              }\n            </p>\n          </div>\n          {user?.role !== \"admin\" && (\n          <button onClick={() => setShowBookModal(true)} className=\"btn-primary flex items-center space-x-2\">\n            <Plus className=\"h-4 w-4\" />\n            <span>จองนัดหมาย</span>\n          </button>\n          )}\n        </div>\n\n        {/* Appointments List */}\n        {appointments.length === 0 ? (\n          <div className=\"card text-center py-12\">\n            <Calendar className=\"h-16 w-16 text-gray-300 mx-auto mb-4\" />\n            <h3 className=\"text-lg font-medium text-gray-900 mb-2\">ยังไม่มีการนัดหมาย</h3>\n            <p className=\"text-gray-600 mb-4\">\n              {user?.role === \"veterinarian\" \n                ? \"ยังไม่มีนัดหมายที่ต้องดูแล\" \n                : user?.role === \"admin\"\n                ? \"ยังไม่มีการนัดหมายในระบบ\"\n                : \"จองนัดหมายกับสัตวแพทย์เพื่อดูแลสุขภาพสัตว์เลี้ยงของคุณ\"\n              }\n            </p>\n            {user?.role !== \"admin\" && (\n            <button onClick={() => setShowBookModal(true)} className=\"btn-primary\">\n              จองนัดหมายแรก\n            </button>\n            )}\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {appointments.map((appointment) => (\n              <div key={appointment.id} className={`border rounded-lg p-4 ${\n                appointment.status === \"scheduled\" ? \"bg-orange-50\" : \n                appointment.status === \"confirmed\" ? \"bg-green-50\" :\n                appointment.status === \"completed\" ? \"bg-gray-50\" :\n                appointment.status === \"cancelled\" ? \"bg-red-50\" : \"bg-gray-50\"\n              }`}>\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center space-x-2 mb-2\">\n                      <Calendar className=\"h-4 w-4 text-blue-500\" />\n                      <span className=\"font-medium text-gray-900\">\n                        {getAppointmentTypeText(appointment.appointment_type)}\n                      </span>\n                      <span className={`px-2 py-1 text-xs rounded-full ${\n                        appointment.status === \"scheduled\" ? \"bg-orange-100 text-orange-800\" :\n                        appointment.status === \"confirmed\" ? \"bg-green-100 text-green-800\" :\n                        appointment.status === \"completed\" ? \"bg-gray-100 text-gray-800\" :\n                        appointment.status === \"cancelled\" ? \"bg-red-100 text-red-800\" : \"bg-gray-100 text-gray-800\"\n                      }`}>\n                        {getStatusText(appointment.status)}\n                      </span>\n                    </div>\n\n                    <div className=\"grid md:grid-cols-2 gap-4 text-sm text-gray-600\">\n                    <div>\n                        <div className=\"flex items-center space-x-2 mb-1\">\n                          <div className=\"w-6 h-6 bg-gray-200 rounded-full flex items-center justify-center overflow-hidden\">\n                            {userImages[appointment.user?.id] || (appointment.user?.profile_picture_url && appointment.user.profile_picture_url.startsWith('data:')) ? (\n                              <img \n                                src={userImages[appointment.user?.id] || appointment.user.profile_picture_url} \n                                alt={appointment.user?.full_name}\n                                className=\"w-full h-full object-cover\"\n                                onError={(e) => {\n                                  e.target.style.display = 'none'\n                                  e.target.nextSibling.style.display = 'flex'\n                                }}\n                              />\n                            ) : null}\n                            <div className={`w-full h-full flex items-center justify-center ${(userImages[appointment.user?.id] || (appointment.user?.profile_picture_url && appointment.user.profile_picture_url.startsWith('data:'))) ? 'hidden' : 'flex'}`}>\n                              <svg className=\"h-3 w-3 text-gray-400\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                                <path fillRule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clipRule=\"evenodd\" />\n                              </svg>\n                            </div>\n                          </div>\n                          <p><strong>เจ้าของ:</strong> {appointment.user?.full_name || appointment.user?.email || 'ไม่ระบุ'}</p>\n                        </div>\n                        <p><strong>สัตว์เลี้ยง:</strong> {appointment.pets?.name || 'ไม่ระบุ'} ({appointment.pets?.species || 'ไม่ระบุ'})</p>\n                        <p><strong>สัตวแพทย์:</strong> {appointment.veterinarian?.full_name || appointment.veterinarian?.email || 'ไม่ระบุ'}</p>\n                        </div>\n                      <div>\n                        <p><strong>วันที่:</strong> {formatDateTime(appointment.appointment_date)}</p>\n                        <p><strong>สร้างเมื่อ:</strong> {formatDateTime(appointment.created_at)}</p>\n                      </div>\n                    </div>\n\n                    {appointment.notes && (\n                      <div className=\"mt-3 p-3 bg-gray-50 rounded-md\">\n                        <p className=\"text-sm text-gray-700\">\n                          <strong>หมายเหตุ:</strong> {appointment.notes}\n                        </p>\n                      </div>\n                    )}\n                  </div>\n\n                  <div className=\"flex flex-col space-y-2 ml-4\">\n                    <button\n                      onClick={() => {\n                        setSelectedAppointment(appointment);\n                        setShowDetailModal(true);\n                      }}\n                      className=\"text-blue-600 hover:text-blue-800 text-sm font-medium\"\n                    >\n                      ดูรายละเอียด\n                    </button>\n                    \n                    {appointment.status === \"scheduled\" && user?.role === \"admin\" && (\n                      <div className=\"flex space-x-2\">\n                        <button\n                          onClick={() => handleApprovalAction(appointment, \"approve\")}\n                          className=\"flex items-center space-x-1 bg-green-500 text-white px-3 py-1 rounded-md text-sm hover:bg-green-600\"\n                        >\n                          <CheckCircle className=\"h-4 w-4\" />\n                          <span>อนุมัติ</span>\n                        </button>\n                        <button\n                          onClick={() => handleApprovalAction(appointment, \"reject\")}\n                          className=\"flex items-center space-x-1 bg-red-500 text-white px-3 py-1 rounded-md text-sm hover:bg-red-600\"\n                        >\n                          <XCircle className=\"h-4 w-4\" />\n                          <span>ปฏิเสธ</span>\n                        </button>\n                      </div>\n                    )}\n                    \n                    {appointment.status === \"scheduled\" && user?.role !== \"admin\" && (\n                      <div className=\"flex space-x-2\">\n                        <button \n                          onClick={() => handleUpdateStatus(appointment.id, 'confirmed')} \n                          disabled={updatingStatus.has(appointment.id)}\n                          className={`text-green-600 hover:text-green-700 ${updatingStatus.has(appointment.id) ? 'opacity-50 cursor-not-allowed' : ''}`} \n                          title=\"ยืนยันนัดหมาย\"\n                        >\n                          <CheckCircle className=\"h-5 w-5\" />\n                        </button>\n                        <button \n                          onClick={() => handleUpdateStatus(appointment.id, 'cancelled')} \n                          disabled={updatingStatus.has(appointment.id)}\n                          className={`text-red-600 hover:text-red-700 ${updatingStatus.has(appointment.id) ? 'opacity-50 cursor-not-allowed' : ''}`} \n                          title=\"ยกเลิกนัดหมาย\"\n                        >\n                          <XCircle className=\"h-5 w-5\" />\n                        </button>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Book Appointment Modal */}\n      {showBookModal && (\n        <BookAppointmentModal onClose={() => setShowBookModal(false)} onAppointmentBooked={handleAppointmentBooked} />\n      )}\n\n      {/* Appointment Detail Modal */}\n      {showDetailModal && selectedAppointment && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\n          <div className=\"bg-white rounded-xl max-w-md w-full\">\n            <div className=\"flex items-center justify-between p-6 border-b\">\n              <h2 className=\"text-xl font-bold text-gray-900\">รายละเอียดนัดหมาย</h2>\n              <button onClick={() => setShowDetailModal(false)} className=\"text-gray-400 hover:text-gray-600\">\n                <XCircle className=\"h-6 w-6\" />\n              </button>\n            </div>\n            <div className=\"p-6 space-y-4\">\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <p className=\"font-semibold text-gray-700\">สัตว์เลี้ยง</p>\n                  <p className=\"text-gray-900\">{selectedAppointment.pets?.name || 'ไม่ระบุ'}</p>\n                </div>\n                <div>\n                  <p className=\"font-semibold text-gray-700\">ประเภทสัตว์</p>\n                  <p className=\"text-gray-900\">{selectedAppointment.pets?.species || 'ไม่ระบุ'} - {selectedAppointment.pets?.breed || 'ไม่ระบุ'}</p>\n                </div>\n                <div>\n                  <p className=\"font-semibold text-gray-700\">สี</p>\n                  <p className=\"text-gray-900\">{selectedAppointment.pets?.color || 'ไม่ระบุ'}</p>\n                </div>\n                <div>\n                  <p className=\"font-semibold text-gray-700\">น้ำหนัก</p>\n                  <p className=\"text-gray-900\">{selectedAppointment.pets?.weight ? `${selectedAppointment.pets.weight} กก.` : 'ไม่ระบุ'}</p>\n                </div>\n              </div>\n              \n              {(user?.role === \"veterinarian\" || user?.role === \"admin\") && selectedAppointment.user && (\n                <div className=\"border-t pt-4\">\n                  <div className=\"flex items-center space-x-3\">\n                    <div className=\"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center overflow-hidden\">\n                      {selectedAppointment.user?.profile_picture_url ? (\n                        <img \n                          src={selectedAppointment.user.profile_picture_url} \n                          alt={selectedAppointment.user?.full_name}\n                          className=\"w-full h-full object-cover\"\n                          onError={(e) => {\n                            e.target.style.display = 'none'\n                            e.target.nextSibling.style.display = 'flex'\n                          }}\n                        />\n                      ) : null}\n                      <div className={`w-full h-full flex items-center justify-center ${selectedAppointment.user?.profile_picture_url ? 'hidden' : 'flex'}`}>\n                        <svg className=\"h-5 w-5 text-gray-400\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                          <path fillRule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clipRule=\"evenodd\" />\n                        </svg>\n                      </div>\n                    </div>\n                    <div>\n                      <p className=\"font-semibold text-gray-700\">เจ้าของสัตว์เลี้ยง</p>\n                      <p className=\"text-gray-900\">{selectedAppointment.user?.full_name || selectedAppointment.user?.email || 'ไม่ระบุ'}</p>\n                    </div>\n                  </div>\n                </div>\n              )}\n              \n              <div className=\"border-t pt-4\">\n                <p className=\"font-semibold text-gray-700\">สัตวแพทย์</p>\n                <p className=\"text-gray-900\">{selectedAppointment.veterinarian?.full_name || selectedAppointment.veterinarian?.email || 'ไม่ระบุ'}</p>\n              </div>\n              \n              <div className=\"border-t pt-4\">\n                <p className=\"font-semibold text-gray-700\">วันที่และเวลา</p>\n                <p className=\"text-gray-900\">{new Date(selectedAppointment.appointment_date).toLocaleString('th-TH')}</p>\n              </div>\n              \n              <div className=\"border-t pt-4\">\n                <p className=\"font-semibold text-gray-700\">ประเภทการนัดหมาย</p>\n                <p className=\"text-gray-900\">{getAppointmentTypeText(selectedAppointment.appointment_type)}</p>\n              </div>\n              \n              <div className=\"border-t pt-4\">\n                <p className=\"font-semibold text-gray-700\">สถานะ</p>\n                <span className={`px-3 py-1 rounded-full text-sm font-medium ${getStatusColor(selectedAppointment.status)}`}>\n                  {getStatusText(selectedAppointment.status)}\n                </span>\n              </div>\n              \n              {selectedAppointment.notes && (\n                <div className=\"border-t pt-4\">\n                  <p className=\"font-semibold text-gray-700\">หมายเหตุ</p>\n                  <p className=\"text-gray-900\">{selectedAppointment.notes}</p>\n                </div>\n              )}\n              \n              <div className=\"border-t pt-4 text-xs text-gray-500\">\n                <p>สร้างเมื่อ: {new Date(selectedAppointment.created_at).toLocaleString('th-TH')}</p>\n                {selectedAppointment.updated_at && selectedAppointment.updated_at !== selectedAppointment.created_at && (\n                  <p>อัปเดตล่าสุด: {new Date(selectedAppointment.updated_at).toLocaleString('th-TH')}</p>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Approval Modal */}\n      {showApprovalModal && selectedAppointment && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\n          <div className=\"bg-white rounded-xl max-w-md w-full\">\n            <div className=\"flex items-center justify-between p-6 border-b\">\n              <h2 className=\"text-xl font-bold text-gray-900\">\n                {approvalAction === \"approve\" ? \"อนุมัติ\" : \"ปฏิเสธ\"}การนัดหมาย\n              </h2>\n              <button onClick={() => setShowApprovalModal(false)} className=\"text-gray-400 hover:text-gray-600\">\n                <XCircle className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <div className=\"p-6\">\n              <div className=\"mb-4\">\n                <h3 className=\"font-medium text-gray-900 mb-2\">รายละเอียด:</h3>\n                <div className=\"text-sm text-gray-600 space-y-1\">\n                  <p><strong>ประเภท:</strong> {getAppointmentTypeText(selectedAppointment.appointment_type)}</p>\n                  <div className=\"flex items-center space-x-2\">\n                    <div className=\"w-5 h-5 bg-gray-200 rounded-full flex items-center justify-center overflow-hidden\">\n                      {selectedAppointment.user?.profile_picture_url ? (\n                        <img \n                          src={selectedAppointment.user.profile_picture_url} \n                          alt={selectedAppointment.user?.full_name}\n                          className=\"w-full h-full object-cover\"\n                          onError={(e) => {\n                            e.target.style.display = 'none'\n                            e.target.nextSibling.style.display = 'flex'\n                          }}\n                        />\n                      ) : null}\n                      <div className={`w-full h-full flex items-center justify-center ${selectedAppointment.user?.profile_picture_url ? 'hidden' : 'flex'}`}>\n                        <svg className=\"h-3 w-3 text-gray-400\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                          <path fillRule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clipRule=\"evenodd\" />\n                        </svg>\n                      </div>\n                    </div>\n                    <p><strong>เจ้าของ:</strong> {selectedAppointment.user?.full_name || selectedAppointment.user?.email || 'ไม่ระบุ'}</p>\n                  </div>\n                  <p><strong>สัตว์เลี้ยง:</strong> {selectedAppointment.pets?.name || 'ไม่ระบุ'}</p>\n                  <p><strong>สัตวแพทย์:</strong> {selectedAppointment.veterinarian?.full_name || selectedAppointment.veterinarian?.email || 'ไม่ระบุ'}</p>\n                  <p><strong>วันที่:</strong> {formatDateTime(selectedAppointment.appointment_date)}</p>\n                </div>\n              </div>\n\n              {approvalAction === \"reject\" && (\n                <div className=\"mb-4\">\n                  <label htmlFor=\"rejectionReason\" className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    เหตุผลในการปฏิเสธ *\n                  </label>\n                  <textarea\n                    id=\"rejectionReason\"\n                    rows=\"3\"\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500\"\n                    placeholder=\"กรุณาระบุเหตุผล...\"\n                    value={rejectionReason}\n                    onChange={(e) => setRejectionReason(e.target.value)}\n                    required\n                  />\n                </div>\n              )}\n\n              <div className=\"flex space-x-3\">\n                <button\n                  onClick={() => setShowApprovalModal(false)}\n                  className=\"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors\"\n                >\n                  ยกเลิก\n                </button>\n                <button\n                  onClick={processApproval}\n                  disabled={processingApproval || (approvalAction === \"reject\" && !rejectionReason.trim())}\n                  className={`flex-1 px-4 py-2 rounded-lg text-white transition-colors disabled:opacity-50 disabled:cursor-not-allowed ${\n                    approvalAction === \"approve\" ? \"bg-green-500 hover:bg-green-600\" : \"bg-red-500 hover:bg-red-600\"\n                  }`}\n                >\n                  {processingApproval ? \"กำลังดำเนินการ...\" : approvalAction === \"approve\" ? \"อนุมัติ\" : \"ปฏิเสธ\"}\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n\nexport default Appointments\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}